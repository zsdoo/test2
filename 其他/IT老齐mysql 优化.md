## 1 数据库设计三范式

![image-20211018202443812](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018202443812.png)



![image-20211018202629898](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018202629898.png)

![image-20211018202825728](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018202825728.png)

![image-20211018202938616](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018202938616.png)

![image-20211018203038569](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018203038569.png)

![image-20211018203137310](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018203137310.png)

![image-20211018203224107](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018203224107.png)

![image-20211018204054159](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018204054159.png)

![image-20211018204106240](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018204106240.png)

![image-20211018204157180](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018204157180.png)

![image-20211018204232366](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018204232366.png)

![image-20211018204525351](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018204525351.png)

![image-20211018212224019](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212224019.png)

![image-20211018212419284](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212419284.png)

![image-20211018212437523](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212437523.png)

![image-20211018212622877](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212622877.png)

![image-20211018212653778](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212653778.png)

![image-20211018212744720](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212744720.png)

![image-20211018212916617](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212916617.png)

![image-20211018212940930](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018212940930.png)

![image-20211018213108094](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018213108094.png)

![image-20211018213456481](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018213456481.png)

![image-20211018213505976](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018213505976.png)

![image-20211018213639898](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018213639898.png)

![image-20211018213730554](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018213730554.png)

![image-20211018213947644](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018213947644.png)

![image-20211018215113735](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018215113735.png)

![image-20211018215448885](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018215448885.png)

![image-20211018215606492](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018215606492.png)

![image-20211018215740768](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018215740768.png)

![image-20211018215832389](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018215832389.png)

![image-20211018220001345](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018220001345.png)

![image-20211018220612284](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018220612284.png)





## 2 MySQL调优实战-存储引擎篇

![image-20211018220837090](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018220837090.png)

![image-20211018220901839](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018220901839.png)

![image-20211018221515047](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018221515047.png)

##### Innodb

![image-20211018221600658](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018221600658.png)

![image-20211018221720277](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018221720277.png)

![image-20211018222329977](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018222329977.png)

![image-20211018221901712](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018221901712.png)

![image-20211018222033692](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018222033692.png)

![image-20211018222421740](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018222421740.png)

![image-20211018222503624](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018222503624.png)

![image-20211018222514093](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018222514093.png)

![image-20211018222949710](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018222949710.png)

##### 只有使用索引的更新操作才会使用行级锁，否则会使用表级锁



##### Myisam

![image-20211018223110113](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018223110113.png)

![image-20211018223124779](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018223124779.png)

![image-20211018223244442](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018223244442.png)

![image-20211018223459791](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018223459791.png)

![image-20211018223639802](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018223639802.png)

##### Memory

![image-20211018223809202](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018223809202.png)

![image-20211018223906817](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018223906817.png)

![image-20211018224048739](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224048739.png)

![image-20211018224215900](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224215900.png)

![image-20211018224327684](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224327684.png)

![image-20211018224558258](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224558258.png)

##### CSV

![image-20211018224616634](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224616634.png)

![image-20211018224642178](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224642178.png)

![image-20211018224759690](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224759690.png)

![image-20211018224949879](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211018224949879.png)



## 3 索引调优篇

![image-20211019093834589](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019093834589.png)

![image-20211019093923724](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019093923724.png)

![image-20211019094134014](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019094134014.png)

![image-20211019094435705](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019094435705.png)

![image-20211019095005178](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019095005178.png)

![image-20211019095048462](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019095048462.png)

![image-20211019095148469](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019095148469.png)

![image-20211019095159252](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019095159252.png)

![image-20211019095556825](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019095556825.png)

![image-20211019095829277](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019095829277.png)

![image-20211019100024498](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019100024498.png)

![image-20211019101014886](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019101014886.png)

![image-20211019101153483](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019101153483.png)

![image-20211019101207029](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019101207029.png)

![image-20211019101309391](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019101309391.png)

![image-20211019102114950](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019102114950.png)

![image-20211019102307369](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019102307369.png)

##### 遇到需要like的查询，建议把这部分数据剥离出来，成为一个单独的全文检索服务器，Elasticsearch一个基于Lucene的搜索服务器

![image-20211019103018319](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019103018319.png)

##### 最后的改进修改，因为数据量太大也没有遇到索引。单通过索引无法解决了，可以考虑放到内存中，或通过NOsql来解决

![image-20211019103043136](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019103043136.png)

![image-20211019112121162](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019112121162.png)

![image-20211019112223679](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019112223679.png)

![image-20211019180944728](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019180944728.png)

![image-20211019181042719](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181042719.png)

![image-20211019181127567](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181127567.png)

![image-20211019181245385](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181245385.png)

![image-20211019181254267](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181254267.png)

![image-20211019181406833](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181406833.png)

![image-20211019181746656](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181746656.png)

![image-20211019181841451](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181841451.png)

![image-20211019181912367](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019181912367.png)

![image-20211019182046282](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182046282.png)

![image-20211019182135013](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182135013.png)

![image-20211019182414830](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182414830.png)

##### 删除冗余索引

![image-20211019182454561](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182454561.png)

![image-20211019182541927](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182541927.png)

![image-20211019182549835](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182549835.png)

<img src="C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182624369.png" alt="image-20211019182624369" style="zoom:50%;" />

<img src="C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182707967.png" alt="image-20211019182707967" style="zoom:50%;" />

![image-20211019182726493](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182726493.png)

![image-20211019182845707](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019182845707.png)

##### ！重点：0代表未被读取，可考虑删除



![image-20211019183611381](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019183611381.png)

![image-20211019183646556](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019183646556.png)

![image-20211019183728281](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019183728281.png)

![image-20211019183747560](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019183747560.png)

![image-20211019183758538](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019183758538.png)

![image-20211019183807478](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019183807478.png)



![image-20211019183930974](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019183930974.png)

##### 1 如果count统计数据为0说明没有用到索引，可以考虑删除

##### 2 如果index_name为空，说明进行了全表扫描！

##### 3 sum_timer_wait 说明使用时间长短，越长使用率越高，越要重点关注分析优化

![image-20211019184238740](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019184238740.png)

#### 关于多表关联优化

![image-20211019184257543](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019184257543.png)

![image-20211019184543038](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019184543038.png)

![image-20211019185042169](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019185042169.png)

![image-20211019185156726](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019185156726.png)

![image-20211019185245275](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019185245275.png)



## 4 MySQL调优实战-慢SQL与执行计划篇

![image-20211019214145666](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019214145666.png)

![image-20211019232505722](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019232505722.png)

![image-20211019214613548](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019214613548.png)

##### set global long_query_time=0.3  视情况而定，300毫秒为慢sql

![image-20211019214927996](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019214927996.png)



#### explain

![image-20211019232540397](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019232540397.png)

![image-20211019233925931](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019233925931.png)

##### ID 的顺序是按select 出现的顺序增长

![image-20211019234124060](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019234124060.png)

![image-20211019234618769](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019234618769.png)

##### 尽量不使用union，因为using tempro, 临时表是不使用所引的

##### subquery: 包含在select中的子查询

![image-20211019234423366](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019234423366.png)

![image-20211019235151459](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019235151459.png)

![image-20211019235612513](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211019235612513.png)

![image-20211020000512240](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020000512240.png)

![image-20211020000637076](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020000637076.png)

![image-20211020000959406](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020000959406.png)

![image-20211020001231581](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020001231581.png)

![image-20211020001636108](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020001636108.png)

![image-20211020002408348](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020002408348.png)

![image-20211020002604764](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020002604764.png)

![image-20211020003122340](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020003122340.png)

Using index condition：在5.6版本后加入的新特性（Index Condition Pushdown）;
![img](https://segmentfault.com/img/bVrL3o) 

Using index condition 会先条件过滤索引，过滤完索引后找到所有符合索引条件的数据行，随后用 WHERE 子句中的其他条件去过滤这些数据行；



`Index Condition Pushdown （ICP）`是MySQL使用索引从表中检索行数据的一种优化方式。

禁用ICP时，存储引擎会通过遍历索引定位基表中的行，然后返回给Server层，再去为这些数据行进行where条件的过滤。

启用ICP时，如果where条件可以使用索引，MySQL会把这部分过滤操作放到存储引擎层，存储引擎通过索引过滤，把满足的行从表中读取出。 **ICP可以减少存储引擎必须访问基表的次数以及Server曾必须访问存储引擎的次数。**



```sql
https://www.fujieace.com/mysql/extra-using-index-condition.html

using index condition：搜索条件中虽然出现了索引列，但是有部分条件无法使用索引，会根据能用索引的条件先搜索一遍再匹配无法使用索引的条件


TINYINT[(M)] [UNSIGNED] [ZEROFILL]  M默认为4
很小的整数。带符号的范围是-128到127。无符号的范围是0到255。
字段类型不一样，会造成 key_len 长度不一样，索引的结果也不能保证一致性，从而造成结果一部份有索引，一部份没有索引，所以才提示了 Extra = Using index condition 。
解决方法如下：我只需要把类型：tinyint 改为 bigint 就可以了。
```



![image-20211020003415312](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020003415312.png)



## 5 分库分表与ShardingJDBC篇

![image-20211020100255828](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020100255828.png)

![image-20211020100305654](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020100305654.png)

![image-20211020100702381](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020100702381.png)

![image-20211020101041882](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020101041882.png)

![image-20211020101201503](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020101201503.png)

![image-20211020101329448](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020101329448.png)

![image-20211020101422414](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020101422414.png)

##### 分区限制

![image-20211020101728371](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020101728371.png)



#### 分库分表

![image-20211020101809477](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020101809477.png)

![image-20211020102021754](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020102021754.png)

![image-20211020102235166](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020102235166.png)

![image-20211020102247458](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020102247458.png)

![image-20211020102623211](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020102623211.png)

![image-20211020103746542](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020103746542.png)

![image-20211020104056904](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020104056904.png)

![image-20211020104148904](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020104148904.png)

![image-20211020104202417](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020104202417.png)

![image-20211020104315689](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020104315689.png)

![image-20211020104538378](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020104538378.png)

![image-20211020104627135](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020104627135.png)

![image-20211020105212720](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020105212720.png)

![image-20211020105145063](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020105145063.png)

![image-20211020105438421](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020105438421.png)

![image-20211020105925310](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020105925310.png)

![image-20211020110653686](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020110653686.png)

![image-20211020110757430](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020110757430.png)

![image-20211020111349224](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020111349224.png)



#### 主从同步

![image-20211020111441710](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020111441710.png)

![image-20211020111451949](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020111451949.png)

![image-20211020112044576](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020112044576.png)

![image-20211020112235507](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020112235507.png)

![image-20211020141836221](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020141836221.png)

![image-20211020142442915](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020142442915.png)

![image-20211020142502380](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020142502380.png)

![image-20211020142913790](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020142913790.png)

![image-20211020143151848](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020143151848.png)

![image-20211020143225827](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020143225827.png)

![image-20211020143332260](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020143332260.png)

![image-20211020143414480](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020143414480.png)





## 6 参数与外部环境调优篇

```sql
一、最大连接数据设置：
show variables like '%connection%';
show status like 'threads%'; -- 查看连接状态： 创建多少、已连接多少、正在运行的状态
show status like 'Max_used_connections%';
！！！其中：显示历史最大连接数及时间，一般建议设置上浮50%
show variables like 'back_log%'; -- 超过最大连接数会放入缓冲区中

二、查询缓存（不建议开启：查询缓存的失效非常频繁，只要有对一个表的更新，这个表上所有的查询缓存都会被清空。因此很可能你费劲地把结果存起来，还没使用呢，就被一个更新全清空了。对于更新压力大的数据库来说，查询缓存的命中率会非常低。除非你的业务就是有一张静态表，很长时间才会更新一次。）
show status like '%qcache%';  -- 可长时间观察
-- Qcache_free_memory 剩余缓存
-- Qcache_lowmem_prunes  因内存不足被清除出去的数量
-- Qcache_hits 命中率
-- Qcache_queries_in_cache 缓存中的数量 
-- Qcache_not_cached 未进入缓存的数量

show VARIABLES like 'query_cache_limit';  -- 超出此大小的不被缓存
-- set GLOBAL query_cache_limit=*****;
show VARIABLES like 'query_cache_type%';  -- 查看查询缓存开启状态 0 关闭   1 开启 2 只缓存sql中指定sql_cache的内容

二（2）
show VARIABLES like 'sort_buffer_size%'; -- 可加速order by / group by 。如果内存够大也可以设置大一些

三、innodb参数
##### 缓冲池 （如何设置缓冲池大小）
show GLOBAL VARIABLES like  'innodb_buffer_pool_size'; -- 88G
show GLOBAL status like  'innodb_buffer_pool_pages_data%'; -- 已使用缓存页的数量
show GLOBAL status like  'innodb_buffer_pool_pages_total%'; -- 全部缓存页的数量
show GLOBAL status like  'innodb_page_size%'; -- 缓存页每页的长度
-- 缓冲池使用率：已用/全部=innodb_buffer_pool_pages_data/innodb_buffer_pool_pages_total *100%
！建议设置：使用率>95%  考虑增大缓冲池为物理内存的75%
！使用率<95%  设置为：已用/页大小*1.05=innodb_buffer_pool_pages_data/innodb_page_size * 1.05 / (1024*1024*1024)

四、事物提交时间
show GLOBAL VARIABLES like 'innodb_flush_log_at_trx_commit%';
-- 0不推荐  1 事务-推荐  3 在要求不高，如电商日志时使用

五、双写操作 innodb_doublewrite 
show GLOBAL VARIABLES like 'innodb_doublewrite'; -- 双写保持默认开启
```



![image-20211020144349814](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020144349814.png)

![image-20211020153325483](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020153325483.png)

#### 最大连接数据设置：

![image-20211020153755222](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020153755222.png)

![image-20211020154058466](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020154058466.png)

![image-20211020155116001](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020155116001.png)

![image-20211020155452054](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020155452054.png)

![image-20211020160359782](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020160359782.png)

##### 连接时间

![image-20211020161216779](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020161216779.png)

##### 查询缓存  show status like '%qcache%';

![image-20211020161248744](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020161248744.png)

![image-20211020161750599](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020161750599.png)

![image-20211020162139736](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020162139736.png)

![image-20211020162354936](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020162354936.png)



##### 设置缓存

![image-20211020162615888](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020162615888.png)

![image-20211020162802098](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020162802098.png)

![image-20211020163217700](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020163217700.png)

![image-20211020163358204](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020163358204.png)



#### innodb 参数



![image-20211020164504900](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020164504900.png)



##### 缓冲池 （如何设置缓冲池大小）

show GLOBAL VARIABLES like  'innodb_buffer_pool_size';

show GLOBAL status like  'innodb_buffer_pool%';

![image-20211020165305261](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020165305261.png)

set global innodb_buffer_pool_size= ***;



##### 事物提交时间

innodb_flush_log_at_trx_commit

![image-20211020165819270](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020165819270.png)

![image-20211020170232570](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020170232570.png)



##### 双写操作 innodb_doublewrite

![image-20211020170455756](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020170455756.png)



##### 线程并发量：innodb_thread_concurrency

![image-20211020171007059](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020171007059.png)



#### centos 7

/etc/sysctl.conf

![image-20211020171136031](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020171136031.png)

![image-20211020171328653](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020171328653.png)

![image-20211020171648283](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020171648283.png)

![image-20211020172137655](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020172137655.png)

![image-20211020172358287](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020172358287.png)

![image-20211020172543984](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020172543984.png)

![image-20211020172630837](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020172630837.png)

![image-20211020172833857](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020172833857.png)

![image-20211020173059981](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173059981.png)





![image-20211020173148084](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173148084.png)

![image-20211020173301455](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173301455.png)

![image-20211020173408792](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173408792.png)

![image-20211020173441203](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173441203.png)

![image-20211020173602057](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173602057.png)

![image-20211020173734786](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173734786.png)

![image-20211020173755110](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173755110.png)

![image-20211020173827031](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173827031.png)

![image-20211020173909273](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020173909273.png)

![image-20211020174045707](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020174045707.png)

![image-20211020174130912](C:\Users\86132\AppData\Roaming\Typora\typora-user-images\image-20211020174130912.png)

